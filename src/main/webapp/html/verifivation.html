<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/boostrap/bootstrap.min.css">
    <link rel="stylesheet" href="../css/verification.css">

    <title>驗證碼確認</title>

</head>

<body>

    <div class="topnav">

        <img class="logoImg" href="#home" src="../img/Simple_Fitness-logos_white.png" alt="">
        <ul class="list-inline">
            <li>
                <a class="topnavBtn" id="home" href="#home">最新消息</a>
            </li>
            <li>
                <a class="topnavBtn" id="news" href="#news">場館資訊</a>
            </li>
            <li>
                <a class="topnavBtn" id="content" href="#contact">教練資訊</a>
            </li>
            <li>
                <a class="topnavBtn" id="about" href="#about">課程資訊</a>
            </li>
            <li>
                <a class="topnavBtn" id="about" href="#about">收費方式</a>
            </li>
            <!-- <li>
                <a class="topnavBtn" id="about" href="#about">討論區</a>
            </li> -->
            <li class="dropdown">
                <a class="topnavBtn" id="user" href="#user">
                    <img class="icon" src="../img/user.png" alt="" title="會員">
                </a>
                <div class="dropdown-content">
                    <ul>
                        <li><a href="#">會員中心</a></li>
                        <li><a href="#">登入</a></li>
                        <li><a href="#">登出</a></li>
                    </ul>
                </div>
            </li>
        </ul>
    </div>

    <div class="contentArea">
        <div class="login-block">
            <div class="login-input">
                <h4>忘記密碼</h4>
                驗證碼
                <input type="text" class="form-control" placeholder="驗證碼" id="ver-code"><br>
                <button type="button" class="btn-submit" id="confirm">驗證碼確認</button>
                <div id="errMsg" class="error" style="color: red;"></div>
            </div>
        </div>   
    </div>

    <script>
        const ver_code = document.querySelector('#ver-code');
        const errMsg = document.querySelector('#errMsg');
        document.getElementById('confirm').addEventListener('click', () => {
            fetch('http://localhost:8080/simplefitness-servlet/member/verification', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                memInputCode: ver_code.value,
            }),
            })
            .then(resp => resp.json())
            .then(body => {
                errMsg.textContent = '';
                const { successful, message } = body;
                if (successful) {
                    window.alert("驗證碼輸入正確！跳轉至修改密碼");
                    location = './change_pass_forget.html';
                } else {
                    errMsg.textContent = message;
                }
            });
        });

    </script>

</body>

</html>