<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/boostrap/bootstrap.min.css">
    <link rel="stylesheet" href="../css/login.css">

    <title>登入頁面</title>

</head>

<body>

    <div class="topnav">

        <img class="logoImg" href="#home" src="../img/Simple_Fitness-logos_white.png" alt="">
        <ul class="list-inline">
            <li>
                <a class="topnavBtn" id="home" href="#home">最新消息</a>
            </li>
            <li>
                <a class="topnavBtn" id="news" href="#news">場館資訊</a>
            </li>
            <li>
                <a class="topnavBtn" id="content" href="#contact">教練資訊</a>
            </li>
            <li>
                <a class="topnavBtn" id="about" href="#about">課程資訊</a>
            </li>
            <li>
                <a class="topnavBtn" id="about" href="#about">收費方式</a>
            </li>
            <!-- <li>
                <a class="topnavBtn" id="about" href="#about">討論區</a>
            </li> -->
            <li class="dropdown">
                <a class="topnavBtn" id="user" href="#user">
                    <img class="icon" src="../img/user.png" alt="" title="會員">
                </a>
                <div class="dropdown-content">
                    <ul>
                        <li><a href="#">會員中心</a></li>
                        <li><a href="#">登入</a></li>
                        <li><a href="#">登出</a></li>
                    </ul>
                </div>
            </li>
        </ul>
    </div>

    <div class="contentArea">
        <div class="login-block">
            <div class="login-input">
                <h4>會員登入</h4>
                會員帳號
                <input type="text" class="form-control" placeholder="帳號" id="username"><br>
                密碼
                <input type="password" class="form-control" placeholder="密碼" id="password"><br>
                <a href="register.html" class="sign-in">註冊帳號</a>
                <a href="#" class="forget">忘記密碼</a><br>
                <button type="button" class="btn-submit" id="login">登入</button>
                <div id="errMsg" class="error" style="color: red;"></div>
            </div>
        </div>   
    </div>

    <script>
        const username = document.querySelector('#username');
        const password = document.querySelector('#password');
        const errMsg = document.querySelector('#errMsg');
        document.getElementById('login').addEventListener('click', () => {
            fetch('http://localhost:8080/simplefitness-servlet/member/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                memUsername: username.value,
                memPassword: password.value
            }),
            })
            .then(resp => resp.json())
            .then(body => {
                errMsg.textContent = '';
                const { successful, message } = body;
                if (successful) {
                    location = './member_home.html';
                } else {
                errMsg.textContent = message;
                }
            });
        });

    </script>

</body>

</html>